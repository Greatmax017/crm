!window.XMLHttpRequest||window.FileAPI&&FileAPI.shouldLoad||(window.XMLHttpRequest.prototype.setRequestHeader=function(e){return function(k,c){if("__setXHR_"===k){var m=c(this);m instanceof Function&&m(this)}else e.apply(this,arguments)}}(window.XMLHttpRequest.prototype.setRequestHeader));var ngFileUpload=angular.module("ngFileUpload",[]);ngFileUpload.version="12.0.4";
ngFileUpload.service("UploadBase",["$http","$q","$timeout",function(e,k,c){function m(a){function f(a){l.notify&&l.notify(a);h.progressFunc&&c(function(){h.progressFunc(a)})}function q(b){return null!=a._start&&d?{loaded:b.loaded+a._start,total:a._file&&a._file.size||b.total,type:b.type,config:a,lengthComputable:!0,target:b.target}:b}function n(){e(a).then(function(q){d&&a._chunkSize&&!a._finished&&a._file?(f({loaded:a._end,total:a._file&&a._file.size,config:a,type:"progress"}),b.upload(a,!0)):(a._finished&&
delete a._finished,l.resolve(q))},function(a){l.reject(a)},function(a){l.notify(a)})}a.method=a.method||"POST";a.headers=a.headers||{};var l=a._deferred=a._deferred||k.defer(),h=l.promise;a.disableProgress||(a.headers.__setXHR_=function(){return function(b){b&&b.upload&&b.upload.addEventListener&&(a.__XHR=b,a.xhrFn&&a.xhrFn(b),b.upload.addEventListener("progress",function(b){b.config=a;f(q(b))},!1),b.upload.addEventListener("load",function(b){b.lengthComputable&&(b.config=a,f(q(b)))},!1))}});d?a._chunkSize&&
a._end&&!a._finished?(a._start=a._end,a._end+=a._chunkSize,n()):a.resumeSizeUrl?e.get(a.resumeSizeUrl).then(function(b){a._start=a.resumeSizeResponseReader?a.resumeSizeResponseReader(b.data):parseInt((null==b.data.size?b.data:b.data.size).toString());a._chunkSize&&(a._end=a._start+a._chunkSize);n()},function(a){throw a;}):a.resumeSize?a.resumeSize().then(function(b){a._start=b;n()},function(a){throw a;}):(a._chunkSize&&(a._start=0,a._end=a._start+a._chunkSize),n()):n();h.success=function(b){h.then(function(f){b(f.data,
f.status,f.headers,a)});return h};h.error=function(b){h.then(null,function(f){b(f.data,f.status,f.headers,a)});return h};h.progress=function(a){h.progressFunc=a;h.then(null,null,function(b){a(b)});return h};h.abort=h.pause=function(){a.__XHR&&c(function(){a.__XHR.abort()});return h};h.xhr=function(b){a.xhrFn=function(a){return function(){a&&a.apply(h,arguments);b.apply(h,arguments)}}(a.xhrFn);return h};b.promisesCount++;h["finally"](function(){b.promisesCount--});return h}function g(a){var b={},q;
for(q in a)a.hasOwnProperty(q)&&(b[q]=a[q]);return b}var b=this;b.promisesCount=0;this.isResumeSupported=function(){return window.Blob&&window.Blob.prototype.slice};var d=this.isResumeSupported();this.isUploadInProgress=function(){return 0<b.promisesCount};this.rename=function(a,b){a.ngfName=b;return a};this.jsonBlob=function(a){null==a||angular.isString(a)||(a=JSON.stringify(a));a=new window.Blob([a],{type:"application/json"});a._ngfBlob=!0;return a};this.json=function(a){return angular.toJson(a)};
this.isFile=function(a){return null!=a&&(a instanceof window.Blob||a.flashId&&a.name&&a.size)};this.upload=function(a,f){function q(f,h,n){if(void 0!==h)if(angular.isDate(h)&&(h=h.toISOString()),angular.isString(h))f.append(n,h);else if(b.isFile(h)){if(!h._ngfBlob&&(a._file=a._file||h,null!=a._start&&d)){a._end&&a._end>=h.size&&(a._finished=!0,a._end=h.size);var c=h.slice(a._start,a._end||h.size);c.name=h.name;c.ngfName=h.ngfName;a._chunkSize&&(f.append("_chunkSize",a._chunkSize),f.append("_currentChunkSize",
a._end-a._start),f.append("_chunkNumber",Math.floor(a._start/a._chunkSize)),f.append("_totalSize",a._file.size));h=c}c=n.split(",");c[1]&&(h.ngfName=c[1].replace(/^\s+|\s+$/g,""),n=c[0]);a._fileKey=a._fileKey||n;f.append(n,h,h.ngfName||h.name)}else if(angular.isObject(h)){if(h.$$ngfCircularDetection)throw"ngFileUpload: Circular reference in config.data. Make sure specified data for Upload.upload() has no circular reference: "+n;h.$$ngfCircularDetection=!0;try{for(c in h)if(h.hasOwnProperty(c)&&"$$ngfCircularDetection"!==
c){var g=null==a.objectKey?"[i]":a.objectKey;h.length&&-1<parseInt(c)&&(g=null==a.arrayKey?g:a.arrayKey);q(f,h[c],n+g.replace(/[ik]/g,c))}}finally{delete h.$$ngfCircularDetection}}else f.append(n,h)}function n(){a._chunkSize=b.translateScalars(a.resumeChunkSize);a._chunkSize=a._chunkSize?parseInt(a._chunkSize.toString()):null;a.headers=a.headers||{};a.headers["Content-Type"]=void 0;a.transformRequest=a.transformRequest?angular.isArray(a.transformRequest)?a.transformRequest:[a.transformRequest]:[];
a.transformRequest.push(function(b){var f=new window.FormData,n;b=b||a.fields||{};a.file&&(b.file=a.file);for(n in b)if(b.hasOwnProperty(n)){var d=b[n];a.formDataAppender?a.formDataAppender(f,n,d):q(f,d,n)}return f})}f||(a=g(a));a._isDigested||(a._isDigested=!0,n());return m(a)};this.http=function(a){a=g(a);a.transformRequest=a.transformRequest||function(a){return window.ArrayBuffer&&a instanceof window.ArrayBuffer||a instanceof window.Blob?a:e.defaults.transformRequest[0].apply(this,arguments)};
a._chunkSize=b.translateScalars(a.resumeChunkSize);a._chunkSize=a._chunkSize?parseInt(a._chunkSize.toString()):null;return m(a)};this.translateScalars=function(a){if(angular.isString(a)){if(a.search(/kb/i)===a.length-2)return parseFloat(1024*a.substring(0,a.length-2));if(a.search(/mb/i)===a.length-2)return parseFloat(1048576*a.substring(0,a.length-2));if(a.search(/gb/i)===a.length-2)return parseFloat(1073741824*a.substring(0,a.length-2));if(a.search(/b/i)===a.length-1||a.search(/s/i)===a.length-1)return parseFloat(a.substring(0,
a.length-1));if(a.search(/m/i)===a.length-1)return parseFloat(60*a.substring(0,a.length-1));if(a.search(/h/i)===a.length-1)return parseFloat(3600*a.substring(0,a.length-1))}return a};this.urlToBlob=function(a){var b=k.defer();e({url:a,method:"get",responseType:"arraybuffer"}).then(function(a){var n=new Uint8Array(a.data);a=a.headers("content-type")||"image/WebP";n=new window.Blob([n],{type:a});b.resolve(n)},function(a){b.reject(a)});return b.promise};this.setDefaults=function(a){this.defaults=a||
{}};this.defaults={};this.version=ngFileUpload.version}]);
ngFileUpload.service("Upload",["$parse","$timeout","$compile","$q","UploadExif",function(e,k,c,m,g){function b(a,b,d){var h=[f.emptyPromise()];angular.forEach(a,function(c,g){0===c.type.indexOf("image/jpeg")&&f.attrGetter("ngfFixOrientation",b,d,{$file:c})&&h.push(f.happyPromise(f.applyExifRotation(c),c).then(function(b){a.splice(g,1,b)}))});return m.all(h)}function d(b,n,d){var h=f.attrGetter("ngfResize",n,d);if(!h||!f.isResizeSupported()||!b.length)return f.emptyPromise();if(h instanceof Function){var c=
m.defer();h(b).then(function(f){a(f,b,n,d).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)})}else return a(h,b,n,d)}function a(a,b,d,h){function c(e,m){if(0===e.type.indexOf("image")&&(!a.pattern||f.validatePattern(e,a.pattern))){var p=f.resize(e,a.width,a.height,a.quality,a.type,a.ratio,a.centerCrop,function(a,b){return f.attrGetter("ngfResizeIf",d,h,{$width:a,$height:b,$file:e})},!1!==a.restoreExif);g.push(p);p.then(function(a){b.splice(m,1,a)},function(a){e.$error=
"resize";e.$errorParam=(a?(a.message?a.message:a)+": ":"")+(e&&e.name)})}}for(var g=[f.emptyPromise()],e=0;e<b.length;e++)c(b[e],e);return m.all(g)}var f=g;f.getAttrWithDefaults=function(a,b){if(null!=a[b])return a[b];var d=f.defaults[b];return null==d?d:angular.isString(d)?d:JSON.stringify(d)};f.attrGetter=function(a,b,f,d){b=this.getAttrWithDefaults(b,a);if(f)try{return d?e(b)(f,d):e(b)(f)}catch(c){if(a.search(/min|max|pattern/i))return b;throw c;}else return b};f.shouldUpdateOn=function(a,b,d){return(b=
f.attrGetter("ngModelOptions",b,d))&&b.updateOn?-1<b.updateOn.split(" ").indexOf(a):!0};f.emptyPromise=function(){var a=m.defer(),b=arguments;k(function(){a.resolve.apply(a,b)});return a.promise};f.rejectPromise=function(){var a=m.defer(),b=arguments;k(function(){a.reject.apply(a,b)});return a.promise};f.happyPromise=function(a,b){var f=m.defer();a.then(function(a){f.resolve(a)},function(a){k(function(){throw a;});f.resolve(b)});return f.promise};f.updateModel=function(a,c,l,h,g,m,v){function C(b,
d,g,w,C){c.$$ngfPrevValidFiles=b;c.$$ngfPrevInvalidFiles=d;var p=b&&b.length?b[0]:null,A=d&&d.length?d[0]:null;a&&(f.applyModelValidation(a,b),a.$setViewValue(C?p:b));h&&e(h)(l,{$files:b,$file:p,$newFiles:g,$duplicateFiles:w,$invalidFiles:d,$invalidFile:A,$event:m});var E=f.attrGetter("ngfModelInvalid",c);E&&k(function(){e(E).assign(l,C?A:d)});k(function(){})}function z(){function a(b,f){return b.name===f.name&&(b.$ngfOrigSize||b.size)===(f.$ngfOrigSize||f.size)&&b.type===f.type}function b(f){var d;
for(d=0;d<w.length;d++)if(a(f,w[d]))return!0;for(d=0;d<A.length;d++)if(a(f,A[d]))return!0;return!1}if(g){x=[];t=[];for(var f=0;f<g.length;f++)b(g[f])?t.push(g[f]):x.push(g[f])}}function u(a){return angular.isArray(a)?a:[a]}function B(){r=[];F=[];angular.forEach(x,function(a){a.$error?F.push(a):r.push(a)})}function y(){function b(){k(function(){C(E?w.concat(r):r,E?A.concat(F):F,g,t,I)},G&&G.debounce?G.debounce.change||G.debounce:0)}d(H?x:r,c,l).then(function(){H?f.validate(x,w.length,a,c,l).then(function(){B();
b()}):b()},function(a){throw"Could not resize files "+a;})}var x,t=[],w,A,F=[],r=[];w=c.$$ngfPrevValidFiles||[];A=c.$$ngfPrevInvalidFiles||[];a&&a.$modelValue&&(w=u(a.$modelValue));var E=f.attrGetter("ngfKeep",c,l);x=(g||[]).slice(0);"distinct"!==E&&!0!==f.attrGetter("ngfKeepDistinct",c,l)||z(c,l);var I=!E&&!f.attrGetter("ngfMultiple",c,l)&&!f.attrGetter("multiple",c);if(!E||x.length){f.attrGetter("ngfBeforeModelChange",c,l,{$files:g,$file:g&&g.length?g[0]:null,$newFiles:x,$duplicateFiles:t,$event:m});
var H=f.attrGetter("ngfValidateAfterResize",c,l),G=f.attrGetter("ngModelOptions",c,l);f.validate(x,w.length,a,c,l).then(function(){v?C(x,[],g,t,I):(G&&G.allowInvalid||H?r=x:B(),f.attrGetter("ngfFixOrientation",c,l)&&f.isExifSupported()?b(r,c,l).then(function(){y()}):y())})}};return f}]);
ngFileUpload.directive("ngfSelect",["$parse","$timeout","$compile","Upload",function(e,k,c,m){function g(a){var b=a.match(/Android[^\d]*(\d+)\.(\d+)/);return b&&2<b.length?(a=m.defaults.androidFixMinorVersion||4,4>parseInt(b[1])||parseInt(b[1])===a&&parseInt(b[2])<a):-1===a.indexOf("Chrome")&&/.*Windows.*Safari.*/.test(a)}function b(a,b,c,n,l,h,e,m){function k(){return"input"===b[0].tagName.toLowerCase()&&c.type&&"file"===c.type.toLowerCase()}function C(){return w("ngfChange")||w("ngfSelect")}function z(b){if(m.shouldUpdateOn("change",
c,a)){for(var f=b.__files_||b.target&&b.target.files,d=[],h=0;h<f.length;h++)d.push(f[h]);m.updateModel(n,c,a,C(),d.length?d:null,b)}}function u(){if(k())return b;var a=angular.element('<input type="file">');if(b!==a)for(var c=0;c<b[0].attributes.length;c++){var h=b[0].attributes[c];if("type"!==h.name&&"class"!==h.name&&"style"!==h.name){if(null==h.value||""===h.value)"required"===h.name&&(h.value="required"),"multiple"===h.name&&(h.value="multiple");a.attr(h.name,"id"===h.name?"ngf-"+h.value:h.value)}}c=
angular.element("<label>upload</label>");c.css("visibility","hidden").css("position","absolute").css("overflow","hidden").css("width","0px").css("height","0px").css("border","none").css("margin","0px").css("padding","0px").attr("tabindex","-1");d.push({el:b,ref:c});document.body.appendChild(c.append(a)[0]);return a}function B(c){if(b.attr("disabled"))return!1;if(!w("ngfSelectDisabled",a)){var h=y(c);if(null!=h)return h;x(c);try{k()||document.body.contains(r[0])||(d.push({el:b,ref:r.parent()}),document.body.appendChild(r.parent()[0]),
r.bind("change",z))}catch(l){}g(navigator.userAgent)?setTimeout(function(){r[0].click()},0):r[0].click();return!1}}function y(a){var b=a.changedTouches||a.originalEvent&&a.originalEvent.changedTouches;if("touchstart"===a.type)return F=b?b[0].clientY:0,!0;a.stopPropagation();a.preventDefault();if("touchend"===a.type&&20<Math.abs((b?b[0].clientY:0)-F))return!1}function x(b){m.shouldUpdateOn("click",c,a)&&r.val()&&(r.val(null),m.updateModel(n,c,a,C(),null,b,!0))}function t(a){if(r&&!r.attr("__ngf_ie10_Fix_")){if(r[0].parentNode)return a.preventDefault(),
a.stopPropagation(),r.unbind("click"),a=r.clone(),r.replaceWith(a),r=a,r.attr("__ngf_ie10_Fix_","true"),r.bind("change",z),r.bind("click",t),r[0].click(),!1;r=null}else r.removeAttr("__ngf_ie10_Fix_")}var w=function(a,b){return m.attrGetter(a,c,b)};m.registerModelChangeValidator(n,c,a);var A=[];A.push(a.$watch(w("ngfMultiple"),function(){r.attr("multiple",w("ngfMultiple",a))}));A.push(a.$watch(w("ngfCapture"),function(){r.attr("capture",w("ngfCapture",a))}));A.push(a.$watch(w("ngfAccept"),function(){r.attr("accept",
w("ngfAccept",a))}));c.$observe("accept",function(){r.attr("accept",w("accept"))});A.push(function(){c.$$observers&&delete c.$$observers.accept});var F=0,r=b;k()||(r=u());r.bind("change",z);k()?b.bind("click",x):b.bind("click touchstart touchend",B);-1!==navigator.appVersion.indexOf("MSIE 10")&&r.bind("click",t);n&&n.$formatters.push(function(a){(null==a||0===a.length)&&r.val()&&r.val(null);return a});a.$on("$destroy",function(){k()||r.parent().remove();angular.forEach(A,function(a){a()})});h(function(){for(var a=
0;a<d.length;a++){var b=d[a];document.body.contains(b.el[0])||(d.splice(a,1),b.ref.remove())}});window.FileAPI&&window.FileAPI.ngfFixIE&&window.FileAPI.ngfFixIE(b,r,z)}var d=[];return{restrict:"AEC",require:"?ngModel",link:function(a,f,d,g){b(a,f,d,g,e,k,c,m)}}}]);
(function(){function e(c){return"img"===c.tagName.toLowerCase()?"image":"audio"===c.tagName.toLowerCase()?"audio":"video"===c.tagName.toLowerCase()?"video":/./}function k(c,m,g,b,d,a,f,q){function n(a){var f=c.attrGetter("ngfNoObjectUrl",d,g);c.dataUrl(a,f)["finally"](function(){m(function(){var d=(f?a.$ngfDataUrl:a.$ngfBlobUrl)||a.$ngfDataUrl;q?b.css("background-image","url('"+(d||"")+"')"):b.attr("src",d);d?b.removeClass("ng-hide"):b.addClass("ng-hide")})})}m(function(){var l=g.$watch(d[a],function(d){var g=
f;"ngfThumbnail"===a&&(g||(g={width:b[0].clientWidth,height:b[0].clientHeight}),0===g.width&&window.getComputedStyle&&(g=getComputedStyle(b[0]),g={width:parseInt(g.width.slice(0,-2)),height:parseInt(g.height.slice(0,-2))}));if(angular.isString(d))return b.removeClass("ng-hide"),q?b.css("background-image","url('"+d+"')"):b.attr("src",d);!d||!d.type||0!==d.type.search(e(b[0]))||q&&0!==d.type.indexOf("image")?b.addClass("ng-hide"):g&&c.isResizeSupported()?c.resize(d,g.width,g.height,g.quality).then(function(a){n(a)},
function(a){throw a;}):n(d)});g.$on("$destroy",function(){l()})})}ngFileUpload.service("UploadDataUrl",["UploadBase","$timeout","$q",function(c,e,g){c.base64DataUrl=function(b){if(angular.isArray(b)){var d=g.defer(),a=0;angular.forEach(b,function(f){c.dataUrl(f,!0)["finally"](function(){a++;if(a===b.length){var f=[];angular.forEach(b,function(a){f.push(a.$ngfDataUrl)});d.resolve(f,b)}})});return d.promise}return c.dataUrl(b,!0)};c.dataUrl=function(b,d){if(!b)return c.emptyPromise(b,b);if(d&&null!=
b.$ngfDataUrl||!d&&null!=b.$ngfBlobUrl)return c.emptyPromise(d?b.$ngfDataUrl:b.$ngfBlobUrl,b);var a=d?b.$$ngfDataUrlPromise:b.$$ngfBlobUrlPromise;if(a)return a;var f=g.defer();e(function(){if(window.FileReader&&b&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 8")||2E4>b.size)&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 9")||4E6>b.size)){var a=window.URL||window.webkitURL;if(a&&a.createObjectURL&&!d){var g;try{g=a.createObjectURL(b)}catch(l){e(function(){b.$ngfBlobUrl="";f.reject()});
return}e(function(){if(b.$ngfBlobUrl=g){f.resolve(g,b);c.blobUrls=c.blobUrls||[];c.blobUrlsTotalSize=c.blobUrlsTotalSize||0;c.blobUrls.push({url:g,size:b.size});c.blobUrlsTotalSize+=b.size||0;for(var d=c.defaults.blobUrlsMaxMemory||268435456,h=c.defaults.blobUrlsMaxQueueSize||200;(c.blobUrlsTotalSize>d||c.blobUrls.length>h)&&1<c.blobUrls.length;){var e=c.blobUrls.splice(0,1)[0];a.revokeObjectURL(e.url);c.blobUrlsTotalSize-=e.size}}})}else{var h=new FileReader;h.onload=function(a){e(function(){b.$ngfDataUrl=
a.target.result;f.resolve(a.target.result,b);e(function(){delete b.$ngfDataUrl},1E3)})};h.onerror=function(){e(function(){b.$ngfDataUrl="";f.reject()})};h.readAsDataURL(b)}}else e(function(){b[d?"$ngfDataUrl":"$ngfBlobUrl"]="";f.reject()})});a=d?b.$$ngfDataUrlPromise=f.promise:b.$$ngfBlobUrlPromise=f.promise;a["finally"](function(){delete b[d?"$$ngfDataUrlPromise":"$$ngfBlobUrlPromise"]});return a};return c}]);ngFileUpload.directive("ngfSrc",["Upload","$timeout",function(c,e){return{restrict:"AE",
link:function(g,b,d){k(c,e,g,b,d,"ngfSrc",c.attrGetter("ngfResize",d,g),!1)}}}]);ngFileUpload.directive("ngfBackground",["Upload","$timeout",function(c,e){return{restrict:"AE",link:function(g,b,d){k(c,e,g,b,d,"ngfBackground",c.attrGetter("ngfResize",d,g),!0)}}}]);ngFileUpload.directive("ngfThumbnail",["Upload","$timeout",function(c,e){return{restrict:"AE",link:function(g,b,d){var a=c.attrGetter("ngfSize",d,g);k(c,e,g,b,d,"ngfThumbnail",a,c.attrGetter("ngfAsBackground",d,g))}}}]);ngFileUpload.config(["$compileProvider",
function(c){c.imgSrcSanitizationWhitelist&&c.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/);c.aHrefSanitizationWhitelist&&c.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/)}]);ngFileUpload.filter("ngfDataUrl",["UploadDataUrl","$sce",function(c,e){return function(g,b,d){if(angular.isString(g))return e.trustAsResourceUrl(g);var a=g&&((b?g.$ngfDataUrl:g.$ngfBlobUrl)||g.$ngfDataUrl);if(g&&!a)return!g.$ngfDataUrlFilterInProgress&&angular.isObject(g)&&
(g.$ngfDataUrlFilterInProgress=!0,c.dataUrl(g,b)),"";g&&delete g.$ngfDataUrlFilterInProgress;return(g&&a?d?e.trustAsResourceUrl(a):a:g)||""}}])})();
ngFileUpload.service("UploadValidate",["UploadDataUrl","$q","$timeout",function(e,k,c){function m(b){var d="",a=[];if(2<b.length&&"/"===b[0]&&"/"===b[b.length-1])d=b.substring(1,b.length-1);else{var f=b.split(",");if(1<f.length)for(b=0;b<f.length;b++){var c=m(f[b]);c.regexp?(d+="("+c.regexp+")",b<f.length-1&&(d+="|")):a=a.concat(c.excludes)}else 0===b.indexOf("!")?a.push("^((?!"+m(b.substring(1)).regexp+").)*$"):(0===b.indexOf(".")&&(b="*"+b),d="^"+b.replace(RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]",
"g"),"\\$&")+"$",d=d.replace(/\\\*/g,".*").replace(/\\\?/g,"."))}return{regexp:d,excludes:a}}function g(b,d){null==d||b.$dirty||(b.$setDirty?b.$setDirty():b.$dirty=!0)}e.validatePattern=function(b,d){if(!d)return!0;var a=m(d),f=!0;a.regexp&&a.regexp.length&&(f=new RegExp(a.regexp,"i"),f=null!=b.type&&f.test(b.type)||null!=b.name&&f.test(b.name));for(var c=a.excludes.length;c--;)var g=new RegExp(a.excludes[c],"i"),f=f&&(null==b.type||g.test(b.type))&&(null==b.name||g.test(b.name));return f};e.ratioToFloat=
function(b){b=b.toString();var d=b.search(/[x:]/i);return b=-1<d?parseFloat(b.substring(0,d))/parseFloat(b.substring(d+1)):parseFloat(b)};e.registerModelChangeValidator=function(b,d,a){b&&b.$formatters.push(function(f){b.$dirty&&(f&&!angular.isArray(f)&&(f=[f]),e.validate(f,0,b,d,a).then(function(){e.applyModelValidation(b,f)}))})};e.applyModelValidation=function(b,d){g(b,d);angular.forEach(b.$ngfValidations,function(a){b.$setValidity(a.name,a.valid)})};e.getValidationAttr=function(b,d,a,f,c){var g=
"ngf"+a[0].toUpperCase()+a.substr(1),g=e.attrGetter(g,b,d,{$file:c});null==g&&(g=e.attrGetter("ngfValidate",b,d,{$file:c}))&&(b=(f||a).split("."),g=g[b[0]],1<b.length&&(g=g&&g[b[1]]));return g};e.validate=function(b,d,a,f,c){function g(d,h,l){if(b){for(var m=b.length,n=null;m--;){var p=b[m];if(p){var k=e.getValidationAttr(f,c,d,h,p);null==k||l(p,k,m)||(p.$error=d,(p.$errorMessages=p.$errorMessages||{})[d]=!0,p.$errorParam=k,b.splice(m,1),n=!1)}}null!==n&&a.$ngfValidations.push({name:d,valid:n})}}
function l(d,g,l,m,n){function p(a,b,f){null!=f?m(b,f).then(function(c){n(c,f)?a.resolve():(b.$error=d,(b.$errorMessages=b.$errorMessages||{})[d]=!0,b.$errorParam=f,a.reject())},function(){h("ngfValidateForce",{$file:b})?(b.$error=d,(b.$errorMessages=b.$errorMessages||{})[d]=!0,b.$errorParam=f,a.reject()):a.resolve()}):a.resolve()}var t=[e.emptyPromise()];if(b)return b=void 0===b.length?[b]:b,angular.forEach(b,function(a){var b=k.defer();t.push(b.promise);!l||null!=a.type&&0===a.type.search(l)?"dimensions"===
d&&null!=e.attrGetter("ngfDimensions",f)?e.imageDimensions(a).then(function(d){p(b,a,h("ngfDimensions",{$file:a,$width:d.width,$height:d.height}))},function(){b.reject()}):"duration"===d&&null!=e.attrGetter("ngfDuration",f)?e.mediaDuration(a).then(function(d){p(b,a,h("ngfDuration",{$file:a,$duration:d}))},function(){b.reject()}):p(b,a,e.getValidationAttr(f,c,d,g,a)):b.resolve()}),k.all(t).then(function(){a.$ngfValidations.push({name:d,valid:!0})},function(){a.$ngfValidations.push({name:d,valid:!1})})}
a=a||{};a.$ngfValidations=a.$ngfValidations||[];angular.forEach(a.$ngfValidations,function(a){a.valid=!0});var h=function(a,b){return e.attrGetter(a,f,c,b)};if(null==b||0===b.length)return e.emptyPromise(a);b=void 0===b.length?[b]:b.slice(0);g("maxFiles",null,function(a,b,f){return d+f<b});g("pattern",null,e.validatePattern);g("minSize","size.min",function(a,b){return a.size+.1>=e.translateScalars(b)});g("maxSize","size.max",function(a,b){return a.size-.1<=e.translateScalars(b)});var m=0;g("maxTotalSize",
null,function(a,d){m+=a.size;return m>e.translateScalars(d)?(b.splice(0,b.length),!1):!0});g("validateFn",null,function(a,b){return!0===b||null===b||""===b});if(!b.length)return e.emptyPromise(a,a.$ngfValidations);var D=k.defer(),v=[];v.push(e.happyPromise(l("maxHeight","height.max",/image/,this.imageDimensions,function(a,b){return a.height<=b})));v.push(e.happyPromise(l("minHeight","height.min",/image/,this.imageDimensions,function(a,b){return a.height>=b})));v.push(e.happyPromise(l("maxWidth","width.max",
/image/,this.imageDimensions,function(a,b){return a.width<=b})));v.push(e.happyPromise(l("minWidth","width.min",/image/,this.imageDimensions,function(a,b){return a.width>=b})));v.push(e.happyPromise(l("dimensions",null,/image/,function(a,b){return e.emptyPromise(b)},function(a){return a})));v.push(e.happyPromise(l("ratio",null,/image/,this.imageDimensions,function(a,b){for(var d=b.toString().split(","),f=!1,c=0;c<d.length;c++)1E-4>Math.abs(a.width/a.height-e.ratioToFloat(d[c]))&&(f=!0);return f})));
v.push(e.happyPromise(l("maxRatio","ratio.max",/image/,this.imageDimensions,function(a,b){return 1E-4>a.width/a.height-e.ratioToFloat(b)})));v.push(e.happyPromise(l("minRatio","ratio.min",/image/,this.imageDimensions,function(a,b){return-1E-4<a.width/a.height-e.ratioToFloat(b)})));v.push(e.happyPromise(l("maxDuration","duration.max",/audio|video/,this.mediaDuration,function(a,b){return a<=e.translateScalars(b)})));v.push(e.happyPromise(l("minDuration","duration.min",/audio|video/,this.mediaDuration,
function(a,b){return a>=e.translateScalars(b)})));v.push(e.happyPromise(l("duration",null,/audio|video/,function(a,b){return e.emptyPromise(b)},function(a){return a})));v.push(e.happyPromise(l("validateAsyncFn",null,null,function(a,b){return b},function(a){return!0===a||null===a||""===a})));return k.all(v).then(function(){D.resolve(a,a.$ngfValidations)})};e.imageDimensions=function(b){if(b.$ngfWidth&&b.$ngfHeight){var d=k.defer();c(function(){d.resolve({width:b.$ngfWidth,height:b.$ngfHeight})});return d.promise}if(b.$ngfDimensionPromise)return b.$ngfDimensionPromise;
var a=k.defer();c(function(){0!==b.type.indexOf("image")?a.reject("not image"):e.dataUrl(b).then(function(d){function g(){var d=l[0].clientWidth,f=l[0].clientHeight;l.remove();b.$ngfWidth=d;b.$ngfHeight=f;a.resolve({width:d,height:f})}function e(){c(function(){l[0].parentNode&&(l[0].clientWidth?g():e())},1E3)}var l=angular.element("<img>").attr("src",d).css("visibility","hidden").css("position","fixed").css("max-width","none !important").css("max-height","none !important");l.on("load",g);l.on("error",
function(){l.remove();a.reject("load error")});e();angular.element(document.getElementsByTagName("body")[0]).append(l)},function(){a.reject("load error")})});b.$ngfDimensionPromise=a.promise;b.$ngfDimensionPromise["finally"](function(){delete b.$ngfDimensionPromise});return b.$ngfDimensionPromise};e.mediaDuration=function(b){if(b.$ngfDuration){var d=k.defer();c(function(){d.resolve(b.$ngfDuration)});return d.promise}if(b.$ngfDurationPromise)return b.$ngfDurationPromise;var a=k.defer();c(function(){0!==
b.type.indexOf("audio")&&0!==b.type.indexOf("video")?a.reject("not media"):e.dataUrl(b).then(function(d){function g(){var d=l[0].duration;b.$ngfDuration=d;l.remove();a.resolve(d)}function e(){c(function(){l[0].parentNode&&(l[0].duration?g():e())},1E3)}var l=angular.element(0===b.type.indexOf("audio")?"<audio>":"<video>").attr("src",d).css("visibility","none").css("position","fixed");l.on("loadedmetadata",g);l.on("error",function(){l.remove();a.reject("load error")});e();angular.element(document.body).append(l)},
function(){a.reject("load error")})});b.$ngfDurationPromise=a.promise;b.$ngfDurationPromise["finally"](function(){delete b.$ngfDurationPromise});return b.$ngfDurationPromise};return e}]);
ngFileUpload.service("UploadResize",["UploadValidate","$q",function(e,k){var c=function(c,g,b,d,a,f,q,n){var l=k.defer(),h=document.createElement("canvas"),p=document.createElement("img");p.onload=function(){var c,m,k,z;if(null!=n&&!1===n(p.width,p.height))l.reject("resizeIf");else try{if(f){var u=e.ratioToFloat(f);p.width/p.height<u?(g=p.width,b=g/u):(b=p.height,g=b*u)}g||(g=p.width);b||(b=p.height);var B=p.width,y=p.height,u=g,x=b,t=q?Math.max(u/B,x/y):Math.min(u/B,x/y);c=B*t;m=y*t;k=B*t-u;z=y*
t-x;h.width=Math.min(c,g);h.height=Math.min(m,b);h.getContext("2d").drawImage(p,Math.min(0,-k/2),Math.min(0,-z/2),c,m);l.resolve(h.toDataURL(a||"image/WebP",d||.934))}catch(w){l.reject(w)}};p.onerror=function(){l.reject()};p.src=c;return l.promise};e.dataUrltoBlob=function(c,g,b){var d=c.split(",");c=d[0].match(/:(.*?);/)[1];for(var d=atob(d[1]),a=d.length,f=new Uint8Array(a);a--;)f[a]=d.charCodeAt(a);c=new window.Blob([f],{type:c});c.name=g;c.$ngfOrigSize=b;return c};e.isResizeSupported=function(){var c=
document.createElement("canvas");return window.atob&&c.getContext&&c.getContext("2d")&&window.Blob};e.isResizeSupported()&&Object.defineProperty(window.Blob.prototype,"name",{get:function(){return this.$ngfName},set:function(c){this.$ngfName=c},configurable:!0});e.resize=function(m,g,b,d,a,f,q,n,l){if(0!==m.type.indexOf("image"))return e.emptyPromise(m);var h=k.defer();e.dataUrl(m,!0).then(function(p){c(p,g,b,d,a||m.type,f,q,n).then(function(a){if("image/jpeg"===m.type&&l)try{a=e.restoreExif(p,a)}catch(b){setTimeout(function(){throw b;
},1)}try{var d=e.dataUrltoBlob(a,m.name,m.size);h.resolve(d)}catch(f){h.reject(f)}},function(a){"resizeIf"===a&&h.resolve(m);h.reject(a)})},function(a){h.reject(a)});return h.promise};return e}]);
(function(){function e(c,e,g,b,d,a,f,q,n,l){function h(){return e.attr("disabled")||u("ngfDropDisabled",c)}function p(a,d){q.updateModel(b,g,c,u("ngfChange")||u("ngfDrop"),a,d)}function D(a,b){if(!q.shouldUpdateOn(a,g,c)||!b)return q.rejectPromise([]);var d=[];b.replace(/<(img src|img [^>]* src) *=\"([^\"]*)\"/gi,function(a,b,f){d.push(f)});var f=[],e=[];if(d.length){angular.forEach(d,function(a){f.push(q.urlToBlob(a).then(function(a){e.push(a)}))});var h=l.defer();l.all(f).then(function(){h.resolve(e)},
function(a){h.reject(a)});return h.promise}return q.emptyPromise()}function v(a,b,d,f){b=u("ngfDragOverClass",a,{$event:d});var c="dragover";if(angular.isString(b))c=b;else if(b&&(b.delay&&(x=b.delay),b.accept||b.reject)){var g=d.dataTransfer.items;if(null!=g&&g.length)for(a=b.pattern||u("ngfPattern",a,{$event:d}),d=g.length;d--;)if(q.validatePattern(g[d],a))c=b.accept;else{c=b.reject;break}else c=b.accept}f(c)}function C(a,b,d,e){function h(a,b){var d=l.defer();if(null!=a)if(a.isDirectory){var f=
[q.emptyPromise()];if(p){var c={type:"directory"};c.name=c.path=(b||"")+a.name+a.name;k.push(c)}var g=a.createReader(),e=[],w=function(){g.readEntries(function(c){try{c.length?(e=e.concat(Array.prototype.slice.call(c||[],0)),w()):(angular.forEach(e.slice(0),function(d){k.length<=n&&t<=m&&f.push(h(d,(b?b:"")+a.name+"/"))}),l.all(f).then(function(){d.resolve()},function(a){d.reject(a)}))}catch(g){d.reject(g)}},function(a){d.reject(a)})};w()}else a.file(function(a){try{a.path=(b?b:"")+a.name,p&&(a=q.rename(a,
a.path)),k.push(a),t+=a.size,d.resolve()}catch(f){d.reject(f)}},function(a){d.reject(a)});return d.promise}var n=q.getValidationAttr(g,c,"maxFiles")||Number.MAX_VALUE,m=q.getValidationAttr(g,c,"maxTotalSize")||Number.MAX_VALUE,p=u("ngfIncludeDir",c),k=[],t=0,x=[q.emptyPromise()];if(a&&0<a.length&&"file"!==f.protocol())for(b=0;b<a.length;b++){if(a[b].webkitGetAsEntry&&a[b].webkitGetAsEntry()&&a[b].webkitGetAsEntry().isDirectory){var v=a[b].webkitGetAsEntry();if(v.isDirectory&&!d)continue;null!=v&&
x.push(h(v))}else v=a[b].getAsFile(),null!=v&&(k.push(v),t+=v.size);if(k.length>n||t>m||!e&&0<k.length)break}else if(null!=b)for(a=0;a<b.length;a++){d=b.item(a);if(d.type||0<d.size)k.push(d),t+=d.size;if(k.length>n||t>m||!e&&0<k.length)break}var D=l.defer();l.all(x).then(function(){if(e||p||!k.length)D.resolve(k);else{for(var a=0;k[a]&&"directory"===k[a].type;)a++;D.resolve([k[a]])}},function(a){D.reject(a)});return D.promise}var z=k(),u=function(a,b,d){return q.attrGetter(a,g,b,d)};u("dropAvailable")&&
a(function(){c[u("dropAvailable")]?c[u("dropAvailable")].value=z:c[u("dropAvailable")]=z});if(z){null==u("ngfSelect")&&q.registerModelChangeValidator(b,g,c);var B=null,y=d(u("ngfStopPropagation")),x=1,t;e[0].addEventListener("dragover",function(b){if(!h()&&q.shouldUpdateOn("drop",g,c)){b.preventDefault();y(c)&&b.stopPropagation();if(-1<navigator.userAgent.indexOf("Chrome")){var d=b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect="move"===d||"linkMove"===d?"move":"copy"}a.cancel(B);t||(t="C",
v(c,g,b,function(a){t=a;e.addClass(t);u("ngfDrag",c,{$isDragging:!0,$class:t,$event:b})}))}},!1);e[0].addEventListener("dragenter",function(a){!h()&&q.shouldUpdateOn("drop",g,c)&&(a.preventDefault(),y(c)&&a.stopPropagation())},!1);e[0].addEventListener("dragleave",function(b){!h()&&q.shouldUpdateOn("drop",g,c)&&(b.preventDefault(),y(c)&&b.stopPropagation(),B=a(function(){t&&e.removeClass(t);t=null;u("ngfDrag",c,{$isDragging:!1,$event:b})},x||100))},!1);e[0].addEventListener("drop",function(a){if(!h()&&
q.shouldUpdateOn("drop",g,c)){a.preventDefault();y(c)&&a.stopPropagation();t&&e.removeClass(t);t=null;var b=a.dataTransfer.items,d;try{d=a.dataTransfer&&a.dataTransfer.getData&&a.dataTransfer.getData("text/html")}catch(f){}C(b,a.dataTransfer.files,!1!==u("ngfAllowDir",c),u("multiple")||u("ngfMultiple",c)).then(function(b){b.length?p(b,a):D("dropUrl",d).then(function(b){p(b,a)})})}},!1);e[0].addEventListener("paste",function(a){-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&u("ngfEnableFirefoxPaste",
c)&&a.preventDefault();if(!h()&&q.shouldUpdateOn("paste",g,c)){var b=[],d=a.clipboardData||a.originalEvent.clipboardData;if(d&&d.items)for(var f=0;f<d.items.length;f++)-1!==d.items[f].type.indexOf("image")&&b.push(d.items[f].getAsFile());b.length?p(b,a):D("pasteUrl",d).then(function(b){p(b,a)})}},!1);-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&u("ngfEnableFirefoxPaste",c)&&(e.attr("contenteditable",!0),e.on("keypress",function(a){a.metaKey||a.ctrlKey||a.preventDefault()}))}else!0===u("ngfHideOnDropNotAvailable",
c)&&e.css("display","none")}function k(){var c=document.createElement("div");return"draggable"in c&&"ondrop"in c&&!/Edge\/12./i.test(navigator.userAgent)}ngFileUpload.directive("ngfDrop",["$parse","$timeout","$location","Upload","$http","$q",function(c,m,g,b,d,a){return{restrict:"AEC",require:"?ngModel",link:function(f,q,n,l){e(f,q,n,l,c,m,g,b,d,a)}}}]);ngFileUpload.directive("ngfNoFileDrop",function(){return function(c,e){k()&&e.css("display","none")}});ngFileUpload.directive("ngfDropAvailable",
["$parse","$timeout","Upload",function(c,e,g){return function(b,d,a){if(k()){var f=c(g.attrGetter("ngfDropAvailable",a));e(function(){f(b);f.assign&&f.assign(b,!0)})}}}])})();
ngFileUpload.service("UploadExif",["UploadResize","$q",function(e,k){function c(c,b,d,a){switch(b){case 2:return c.transform(-1,0,0,1,d,0);case 3:return c.transform(-1,0,0,-1,d,a);case 4:return c.transform(1,0,0,-1,0,a);case 5:return c.transform(0,1,1,0,0,0);case 6:return c.transform(0,1,-1,0,a,0);case 7:return c.transform(0,-1,-1,0,a,d);case 8:return c.transform(0,-1,1,0,0,d)}}function m(c){var b="";c=new Uint8Array(c);for(var d=c.byteLength,a=0;a<d;a++)b+=String.fromCharCode(c[a]);return window.btoa(b)}
e.isExifSupported=function(){return window.FileReader&&(new FileReader).readAsArrayBuffer&&e.isResizeSupported()};e.readOrientation=function(c){var b=k.defer(),d=new FileReader;c=c.slice?c.slice(0,65536):c;d.readAsArrayBuffer(c);d.onerror=function(a){return b.reject(a)};d.onload=function(a){var d={orientation:1},c=new DataView(this.result);if(65496!==c.getUint16(0,!1))return b.resolve(d);for(var g=c.byteLength,e=2;e<g;){var h=c.getUint16(e,!1),e=e+2;if(65505===h){if(1165519206!==c.getUint32(e+=2,
!1))break;for(var h=18761===c.getUint16(e+=6,!1),e=e+c.getUint32(e+4,h),m=c.getUint16(e,h),e=e+2,k=0;k<m;k++)if(274===c.getUint16(e+12*k,h))return g=c.getUint16(e+12*k+8,h),2<=g&&8>=g&&(c.setUint16(e+12*k+8,1,h),d.fixedArrayBuffer=a.target.result),d.orientation=g,b.resolve(d)}else if(65280!==(h&65280))break;else e+=c.getUint16(e,!1)}return b.resolve(d)};return b.promise};e.applyExifRotation=function(g){if(0!==g.type.indexOf("image/jpeg"))return e.emptyPromise(g);var b=k.defer();e.readOrientation(g).then(function(d){if(2>
d.orientation||8<d.orientation)return b.resolve(g);e.dataUrl(g,!0).then(function(a){var f=document.createElement("canvas"),k=document.createElement("img");k.onload=function(){try{f.width=4<d.orientation?k.height:k.width;f.height=4<d.orientation?k.width:k.height;var a=f.getContext("2d");c(a,d.orientation,k.width,k.height);a.drawImage(k,0,0);var l=f.toDataURL(g.type||"image/WebP",.934),l=e.restoreExif(m(d.fixedArrayBuffer),l),h=e.dataUrltoBlob(l,g.name);b.resolve(h)}catch(p){return b.reject(p)}};k.onerror=
function(){b.reject()};k.src=a},function(a){b.reject(a)})},function(d){b.reject(d)});return b.promise};e.restoreExif=function(c,b){return{KEY_STR:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode64:function(b){var a="",c,e,g="",l,h,k="",m=0;do c=b[m++],e=b[m++],g=b[m++],l=c>>2,c=(c&3)<<4|e>>4,h=(e&15)<<2|g>>6,k=g&63,isNaN(e)?h=k=64:isNaN(g)&&(k=64),a=a+this.KEY_STR.charAt(l)+this.KEY_STR.charAt(c)+this.KEY_STR.charAt(h)+this.KEY_STR.charAt(k);while(m<b.length);return a},restore:function(b,
a){b.match("data:image/jpeg;base64,")&&(b=b.replace("data:image/jpeg;base64,",""));var c=this.decode64(b),c=this.slice2Segments(c),c=this.exifManipulation(a,c);return"data:image/jpeg;base64,"+this.encode64(c)},exifManipulation:function(b,a){var c=this.getExifArray(a),c=this.insertExif(b,c);return new Uint8Array(c)},getExifArray:function(b){for(var a,c=0;c<b.length;c++)if(a=b[c],255===a[0]&225===a[1])return a;return[]},insertExif:function(b,a){var c=b.replace("data:image/jpeg;base64,",""),e=this.decode64(c),
g=e.indexOf(255,3),c=e.slice(0,g),e=e.slice(g),c=c.concat(a);return c=c.concat(e)},slice2Segments:function(b){for(var a=0,c=[];!(255===b[a]&218===b[a+1]);){if(255===b[a]&216===b[a+1])a+=2;else{var e=a+(256*b[a+2]+b[a+3])+2,a=b.slice(a,e);c.push(a);a=e}if(a>b.length)break}return c},decode64:function(b){var a,c,e="",g,l="",h=0,k=[];/[^A-Za-z0-9\+\/\=]/g.exec(b)&&console.log("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, NaNExpect errors in decoding.");
b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");do a=this.KEY_STR.indexOf(b.charAt(h++)),c=this.KEY_STR.indexOf(b.charAt(h++)),g=this.KEY_STR.indexOf(b.charAt(h++)),l=this.KEY_STR.indexOf(b.charAt(h++)),a=a<<2|c>>4,c=(c&15)<<4|g>>2,e=(g&3)<<6|l,k.push(a),64!==g&&k.push(c),64!==l&&k.push(e);while(h<b.length);return k}}.restore(c,b)};return e}]);
